# hotelspace

**시연 영상 : (client) https://youtu.be/uzUT_omUI4U (admin) https://youtu.be/gSjk95wzJqE**

* 개발 기간 : 2020.09 ~ 2020.10
* 개발 환경 : window, eclipse, spring 
* 개발 인원 : 7명
* 요약 : 호텔 예약 웹 페이지

### 기능 
>1. Client)날짜 별 호텔 검색, 예약 및 결재
>2. Client) FAQ , QnA
>3. Client) Login, my page
>4. Admin)통계정보 
>5. Admin)회원 관리
>5. Admin)페이지 관리


### 개발취지 (배경)
>Java 언어, 웹과 JDBC ,spring,mybatis 를 이용하여 Database 의 Data 를 운용 및 활용할 수 있다.
### 개발(프로젝트의) 목적
>JDBC 를 통해 Oracle Database 를 사용하여 시스템을 개발하고, Data 를 활용하는 방법을 학습한다. 웹 메이븐 MVC 방식을 숙지한다.
### 프로젝트 개요
>클라이언트가 호텔 검색을 통해 원하는 호텔의 정보들을 알 수 있고, 사이트에 등록된 호텔들을 예약할 수 있고 후기를 남길수 있으며 호텔등록을 원하는 클라이언트는 관리자를 통해 자신의 호텔을 등록 할 수 있다.


* 맡은 기능 : 로그인(kakao login api), 관리자 메인 통계 페이지, 관리자 회원 관리 페이지, 
 클라이언트 메인 페이지, 게시판 및 목록 페이징 처리, 오류 처리
 
 ***
### 맡은 기능 중 주요 페이지

#### 로그인페이지
>로그인을 눌렀을 때 기능
1. 비밀번호와 id를 vo에 받고 id를 통해 회원 정보를 받아온다. (service – dao - mapper이용)
2.  받아온 회원 정보와 reqeust로 받아온 비밀번호를 비교하교, 계정 정지 상태를 비교하여 로그인 실패, 혹은 성공을 response해준다.

>카카오 로그인
1. 카카오 로그인을 위해선 인증코드 받기와 접근 토큰이 필요하다. 로그인 페이지로 이동할 때 response로 인증코드를 받을 수 있는 url을 보내준다.
2. 카카오 로그인을 눌렀을 때 받을 url로 인증코드를 받아준다. (URI속에 redirect url을 보내 kakaoLogin.do로 반환되도록 설정)
3. 인증코드로 접근토큰을 받아준다.
4. 카카오 로그인은 기본적으로 회원가입이 필수이다. 로그인을 눌렀을 때 등록된 카카오 회원이 아니면 회원가입을 해줘야 한다. 가져온 접근 토큰으로 카카오 회원 번호를 가져온 뒤 client 테이블과 비교하여 정보가 없으면 회원가입 페이지로 이동해준다. 있으면 그 회원정보를 세션에 저장하고 로그인을 완료한다.
 
>KakaoAPI.java 객체
1. 접근 토큰을 받기 위한 url로 연결한다.
2. 접근 토큰을 받는데 필요한 파라미터(인증 코드, redirect url등)를 request보낸다.
3. Jsonparser로 접근 토큰을 추출한다.
4. 접근 토큰으로 kakao 번호 id 추출하는 것, 로그아웃도 같은 맥락으로 메소드 만들어준다. 



#### 관리자 회원 페이지 (개인 회원 정보 추출)
>개인 페이지 데이터 불러오기
1. 관리자가 보고싶은 id를 클릭하면 controller에서 받아 service – dao를 통해 데이터를 받아 response한다.
2. mapper.xml에서 select문은 호텔 정보 링크를 주기 위해 리뷰 호텔 id를 인라인 뷰로 출력했다.
3. jstl로 리뷰 및 예약 리스트를 출력시켜 주었다. 호텔 명과 방명을 클릭하면 새 창이 떠서 확인이 가능하도록 함수를 만들어줬다.

>리뷰 삭제 ajax
1. 삭제 버튼을 누르면 해당 리뷰가 삭제되도록 ajax를 만들어줬다.
2. 리뷰의 내용이 길수 있기 때문에 본 내용은 숨겨놓고 + 기호를 눌렀을 때 나타나도록 함수를 작성해주었다. 이를 위해 각 리스트안의 객체에 숫자로 이름을 정해주었다.
3. 지정 id 테이블 열을 숨겨주는 함수
4. 삭제 ajax – 삭제되는 부분을 비연동으로 구현하였다. 서버에서 많은 데이터를 가져오기 보다 삭제된 열을 화면상에서 제거했다.



#### 페이징 처리
>pagination.java
1. 현재 페이지 정보를 가진 멤버객체를 구현해준다. 페이지당 게시글 수, 블록 당 페이지 수는 값은 원하는 값으로 초기화한다. 
2. 생성자에 현제 페이지와 총 게시물 수를 넣어주면 그에 맞는 멤버 변수가 세팅 되도록 초기화 시켜준다.
3. 총 페이지 수를 구하기 위해 총 게시글 수를 페이지 사이즈로 나눠 올림을 해준다. 마찬가지로 총 블록 수를 구하기 위해 총 페이지 수를 블록 사이즈로 나눠 올림을 해준다.
4. 현재 블록을 설정해주기 위해 현재 페이지에 블록 사이즈를 나누어 준다. 그런 다음 
 
>pagination 넘겨주기 및 클라이언트 화면에 출력하기
1. 컨트롤러에서 총 게시글 수와 현재 페이지를 통해 pagination 객체를 생성해서 response해준다.
2. 블록을 넘어가는 [처음], 페이지를 넘어갈 수 있게 하는 [이전]을 만들어주고 forEach태그로 총 블록 사이즈만큼 숫자를 출력해준다. [다음], [끝]도 마찬가지로 뒤의 페이지와 블록이 있을 시 생기도록 해준다.  
